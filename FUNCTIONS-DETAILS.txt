## Maïlis Amico - KU Leuven - mailis.amico@kuleuven.be
## (last update : January 2, 2018) 
## Amico, M., Van Keilegom, I. And Legrand, C. (2017). The single-index/Cox mixture cure model. 

--------------------------------------------------------------
NZD (from np package - https://cran.r-project.org/web/packages/np/index.html)
--------------------------------------------------------------

NZD stands for ’no zero divide’. This function is used to deal with division by zero when using fixed precision architectures. This accomplishes the fact using a simple algorithm from computer science (in the underlying C code). It avoids NaN (not a number) in computations.

Fed a vector/scalar, it checks for a negative/positive value and, if positive divides by the smallest positive floating-point number ‘x’ such that  1 + x != 1, if negative returns the same with appropriate sign.

--------------------------------------------------------------
smsurv (from smcure package - https://cran.r-project.org/web/packages/smcure/index.html)
--------------------------------------------------------------

<b>Description :</b>
The estimated baseline survival function based on the Breslow method, which is used in order to update the E-step in the EM algorithm. 

<b>Usage : </b>
 smsurv(Time, Status, X, beta, w, model)

<b>Arguments :</b>
Time :  follow up time for "ph" model. If model is "aft", then this is residual logt−βx. 

Status:  censoring indicator, 1=event of interest happens, and 0=censoring 

X :  effects of covariates of uncured patients 

beta :  initial beta from coxph 

w :  conditional probability of the ith individual remains uncured at the mth iteration. We use Status as initial value 

model :  specifies your model, it can be "ph" or "aft" 



--------------------------------------------------------------
SIC
--------------------------------------------------------------

Description:
EM algorithm for the estimation of a single-index/Cox mixture cure model.

Usage : 
SIC(Time, Status, gamma.init, beta.init, X, Z, LCMM, eps, emmax, dataset, rescale)

Arguments :
Time : folow-up time
Status : censoring indicator -  1 = event of interest happens, and 0 = censoring
beta.init : initial value for the single-index model (incidence)
gamma.init : initial value for the Cox PH model (latency)
X : covariates considered in the single-index (incidence)
Z : covariates considered in the Cox PH model (latency)
LCMM : a smcure object (see smcure package - https://cran.r-project.org/web/packages/smcure/index.html - for more details about the secure function)
eps : value of the convergence criterion
emmax : maximum number of iteration for the EM algorithm
dataset : a matrix or a data.frame containing the data on which the model has to be estimated
rescale : TRUE/FALSE - if TRUE, parameters of the incidence are rescaled according to an euclidian norm equal to 1

Value :
b : parameter estimates for the single-index (incidence)
h : bandwidth value
beta : parameter estimates for the Cox PH model (latency)
iteration : number of iteration of the EM algorithm
survival : baseline conditional survival function estimate
cured : value of the weight W at the final iteration
pred : estimated value of \gamma^tX and p(X)
h.conv : value given by the Value ‘convergence’ of the optim function for the bandwidth computation 
conv: value given by the Value ‘convergence’ of the optim function for the maximum likelihood

--------------------------------------------------------------
SICMM
--------------------------------------------------------------

Description : 
Estimation of a single-index/Cox mixture cure model with computation of the standard errors of the parameters by bootstrap.

Usage : 
SICMM(Time, Status, X, Z, LCMM, eps, emmax, dataset, rescale, bootstrap, nboot)

Arguments : 
Time : follow-up time
Delta : censoring indicator -  1 = event of interest happens, and 0 = censoring
X : covariates considered in the single-index (incidence)
Z : covariates considered in the Cox PH model (latency)
LCMM : a smcure object (see smcure package - https://cran.r-project.org/web/packages/smcure/index.html - for more details about the secure function)
eps : value of the convergence criterion
emmax : maximum number of iteration for the EM algorithm
dataset : a matrix or a data.frame containing the data on which the model has to be estimated
rescale : TRUE/FALSE - if TRUE, parameters of the incidence are rescaled according to an euclidian norm equal to 1
bootstrap : TRUE/FALSE - if TRUE, computation of the standard errors of the parameters based on a bootstrap approach
nboot : number of bootstrap sampling

Value : 
b : parameter estimates for the single-index (incidence)
b.se : standard errors for vector of parameters b
b.pvalue : p-value for the Wald test for the vector of parameters b
h : bandwidth value
beta : parameter estimates for the Cox PH model (latency)
beta.se : standard errors for vector of parameters beta
beta.pvalue : p-value for the Wald test for the vector of parameters beta
survival : baseline conditional survival function estimate
pred : estimated value of the \gamma^tX and p(X)
h.conv : value given by the Value ‘convergence’ of the optim function for the bandwidth computation 
conv : value given by the Value ‘convergence’ of the optim function for the maximum likelihood


